<openerp>
	<data>

		<record id="view_task_list_view_npg" model="ir.ui.view">
			<field name="name">project.task.tree.npg</field>
			<field name="model">project.task</field>
			<field name="inherit_id" ref="project.view_task_tree2" />
			<field name="arch" type="xml">
				<field name="name" position="before">
					<field name="task_number" string="Task Number" />
					<field name="date_deadline" />
				</field>
				<field name="project_id" position="after">
					<field name="parent_task_id" />
					<field name="parent_task_number" />
				</field>
			</field>
		</record>

		<record id="view_task_search_form_npg" model="ir.ui.view">
			<field name="name">project.task.search.form.npg</field>
			<field name="model">project.task</field>
			<field name="inherit_id" ref="project.view_task_search_form" />
			<field name="arch" type="xml">
				<field name="name" position="before">
					<field name="task_number" string="Task Number" />
				</field>
			</field>
		</record>

		<record id="view_task_gtd_search_form_npg" model="ir.ui.view">
			<field name="name">project.task.search.form.npg</field>
			<field name="model">project.task</field>
			<field name="inherit_id" ref="project_gtd.view_task_gtd_search" />
			<field name="arch" type="xml">
				<field name="name" position="before">
					<field name="task_number" string="Task Number" />
				</field>
			</field>
		</record>



		<record id="hr_timesheet_line_tree_npg" model="ir.ui.view">
			<field name="name">hr.analytic.timesheet.tree.npg</field>
			<field name="model">hr.analytic.timesheet</field>
			<field name="inherit_id" ref="hr_timesheet.hr_timesheet_line_tree" />
			<field name="arch" type="xml">
				<field name="unit_amount" position="replace">
					<field name="unit_amount" string="Duration"
						on_change="on_change_unit_amount(product_id, unit_amount, False, product_uom_id,journal_id)"
						sum="Total time" />
				</field>
			</field>

		</record>

		<record id="view_task_form_npg" model="ir.ui.view">
			<field name="name">project.task.form.npg</field>
			<field name="model">project.task</field>
			<field name="inherit_id" ref="project.view_task_form2" />
			<field name="arch" type="xml">
				<field name="project_id" position="before">
					<!-- <field name="task_number" string="Task Number" /> -->
					<field name="parent_task_number" />
					<field name="parent_task_id" />
				</field>
				<field name="project_id" position="attributes">
					<attribute name="required">1 </attribute>
				</field>

				<xpath expr="//notebook/page[@string='Delegation']" position="before">

					<page string="Notes" groups="project.group_project_user">
						<group>
							<field name="pub_descrip" groups="project.group_project_user"
								nolabel="1" />
						</group>

					</page>

				</xpath>
				<xpath expr="/form/sheet/notebook/page/field[@name='parent_ids']" position="replace">
					<field name="parent_ids" invisible="1"/>
					<field name="parent_task_id" />
					<field name="parent_task_number" />
				</xpath>
				<xpath expr="/form/sheet/notebook/page/field[@name='child_ids']"
					position="replace">
					<field name="child_ids" widget="one2many_list">
						<tree string="Delegated tasks">
							<field name="name" />
							<field name="user_id" />
							<field name="stage_id" />
							<field name="state" invisible="1" />
							<field name="effective_hours" widget="float_time" />
							<field name="progress" widget="progressbar" />
							<field name="remaining_hours" widget="float_time" />
							<field name="date_deadline" />
						</tree>
					</field>
				</xpath>
				<xpath expr="/form/sheet/notebook/page/separator[@string='Parent Tasks']"
					position="before">
					<button name="%(action_view_project_parent_selection_form)d"
						string="Update Parent Tasks" type="action" status = "pending,open,draft" attrs="{'invisible':[('parent_task_id', '!=',False)]}"/>
				</xpath>
			</field>
		</record>
		
		<!-- Chart of Project -->
		
		 <record id="view_project_task_tree_inherits" model="ir.ui.view">
            <field name="name">Project Task.tree</field>
            <field name="model">project.task</field>
            <field name="field_parent">child_ids</field>
            <field name="arch" type="xml">
                <tree string="Chart of Project Task" toolbar="1" >
                    <field name="task_number"/>
                    <field name="name"/>
                    <field name="project_id"/>
                    <field name="parent_task_id"/>
                    <field name="parent_task_number"/>
                    <field name="stage_id"/>
                    <field name="date_start"/>
                    <field name="date_end"/>
                </tree>
            </field>
        </record>
        <record id="action_project_task_tree_inherits" model="ir.actions.act_window">
            <field name="name">Chart of Project Task</field>
            <field name="res_model">project.task</field>
            <field name="view_type">tree</field>
            <field name="view_id" ref="view_project_task_tree_inherits"/>
            <field name="domain">[('parent_task_id','=',False)]</field>
        </record>
		
		 <menuitem action="action_project_task_tree_inherits" id="menu_action_view_project_parent_task" parent="project.menu_project_management" sequence="5"/>
		
	</data>
</openerp>
